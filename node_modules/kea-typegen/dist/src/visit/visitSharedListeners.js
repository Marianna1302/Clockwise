"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.visitSharedListeners = void 0;
const ts = require("typescript");
const ts_clone_node_1 = require("@wessberg/ts-clone-node");
const utils_1 = require("../utils");
function visitSharedListeners(type, inputProperty, parsedLogic) {
    const { checker } = parsedLogic;
    for (const property of type.getProperties()) {
        const name = property.getName();
        const value = property.valueDeclaration.initializer;
        if (value && ts.isFunctionLike(value)) {
            let typeNode;
            const firstParameter = value.parameters[0];
            if (firstParameter) {
                typeNode = (0, ts_clone_node_1.cloneNode)(checker.typeToTypeNode(checker.getTypeAtLocation(firstParameter), undefined, undefined));
                (0, utils_1.gatherImports)(typeNode, checker, parsedLogic);
            }
            parsedLogic.sharedListeners.push({
                name,
                payload: typeNode,
                action: ts.factory.createTypeLiteralNode([
                    ts.factory.createPropertySignature(undefined, ts.factory.createIdentifier('type'), undefined, ts.factory.createKeywordTypeNode(ts.SyntaxKind.StringKeyword)),
                    ts.factory.createPropertySignature(undefined, ts.factory.createIdentifier('payload'), undefined, typeNode || ts.factory.createKeywordTypeNode(ts.SyntaxKind.AnyKeyword)),
                ]),
            });
        }
    }
}
exports.visitSharedListeners = visitSharedListeners;
//# sourceMappingURL=visitSharedListeners.js.map